nohup: ignoring input
[10/21/2025 00:21:41 gluefactory INFO] Starting experiment sp+lg_selfda_homography
[10/21/2025 00:21:41 gluefactory INFO] Using device cuda
[10/21/2025 00:21:47 gluefactory.datasets.base_dataset INFO] Creating dataset HomographyDataset
[10/21/2025 00:21:54 gluefactory.datasets.homographies INFO] Found 1001001 images in list file.
/gemini/final/gluefactory/datasets/augmentations.py:130: UserWarning: Argument(s) 'always_apply' are not valid for transform FromFloat
  self.preprocess = A.FromFloat(always_apply=True, dtype="uint8")
/gemini/final/gluefactory/datasets/augmentations.py:131: UserWarning: Argument(s) 'always_apply' are not valid for transform ToFloat
  self.postprocess = A.ToFloat(always_apply=True)
[10/21/2025 00:21:55 gluefactory INFO] Training loader has 1171 batches
[10/21/2025 00:21:55 gluefactory INFO] Validation loader has 16 batches
[10/21/2025 00:21:57 gluefactory INFO] Parameters with scaled learning rate:
{}
[10/21/2025 00:21:58 gluefactory INFO] Training with mixed_precision=None
[10/21/2025 00:21:58 gluefactory INFO] Starting training with configuration:
data:
  name: homographies
  data_dir: revisitop1m
  train_size: 150000
  val_size: 2000
  batch_size: 128
  num_workers: 14
  homography:
    difficulty: 0.7
    max_angle: 45
  photometric:
    name: lg
model:
  name: two_view_pipeline
  extractor:
    name: gluefactory_nonfree.superpoint
    max_num_keypoints: 512
    force_num_keypoints: true
    detection_threshold: 0.0
    nms_radius: 3
    trainable: false
  ground_truth:
    name: matchers.homography_matcher
    th_positive: 3
    th_negative: 3
  matcher:
    name: matchers.lightglue_selfda
    filter_threshold: 0.1
    flash: false
    checkpointed: true
train:
  seed: 0
  epochs: 40
  optimizer: adam
  opt_regexp: null
  optimizer_options: {}
  lr: 0.0001
  lr_schedule:
    type: exp
    start: 20
    exp_div_10: 10
    on_epoch: true
    factor: 1.0
    options: {}
  lr_scaling:
  - - 100
    - - dampingnet.const
  eval_every_iter: 500
  save_every_iter: 5000
  log_every_iter: 100
  log_grad_every_iter: null
  test_every_epoch: 1
  keep_last_checkpoints: 10
  load_experiment: null
  median_metrics: []
  recall_metrics: {}
  pr_metrics: {}
  best_key: loss/total
  dataset_callback_fn: null
  dataset_callback_on_val: false
  clip_grad: null
  pr_curves: {}
  plot:
  - 5
  - gluefactory.visualization.visualize_batch.make_match_figures
  submodules: []
benchmarks:
  hpatches:
    eval:
      estimator: opencv
      ransac_th: 0.5

[10/21/2025 00:21:58 gluefactory INFO] Starting epoch 0
No fused RMSNorm
[10/21/2025 00:23:15 gluefactory INFO] [E 0 | it 0] loss {total 8.023E+00, last 7.155E+00, assignment_nll 7.155E+00, nll_pos 1.370E+01, nll_neg 6.114E-01, num_matchable 1.852E+02, num_unmatchable 3.130E+02, confidence 8.547E-01, row_norm 5.512E-01}
Evaluation:   0%|          | 0/16 [00:00<?, ?it/s]Evaluation:   6%|6         | 1/16 [00:35<08:50, 35.34s/it]Evaluation:  12%|#2        | 2/16 [00:44<04:38, 19.86s/it]Evaluation:  19%|#8        | 3/16 [00:49<02:50, 13.15s/it]Evaluation:  25%|##5       | 4/16 [00:54<01:58,  9.86s/it]Evaluation:  31%|###1      | 5/16 [00:59<01:28,  8.09s/it]Evaluation:  38%|###7      | 6/16 [01:04<01:10,  7.02s/it]Evaluation:  44%|####3     | 7/16 [01:13<01:09,  7.71s/it]Evaluation:  50%|#####     | 8/16 [01:18<00:54,  6.85s/it]Evaluation:  56%|#####6    | 9/16 [01:27<00:52,  7.51s/it]Evaluation:  62%|######2   | 10/16 [01:36<00:47,  7.97s/it]Evaluation:  69%|######8   | 11/16 [01:41<00:35,  7.02s/it]Evaluation:  75%|#######5  | 12/16 [01:46<00:25,  6.43s/it]Evaluation:  81%|########1 | 13/16 [01:51<00:18,  6.05s/it]Evaluation:  88%|########7 | 14/16 [02:00<00:14,  7.08s/it]Evaluation:  94%|#########3| 15/16 [02:05<00:06,  6.45s/it]Evaluation: 100%|##########| 16/16 [02:17<00:00,  7.95s/it]Evaluation: 100%|##########| 16/16 [02:17<00:00,  8.61s/it]
[10/21/2025 00:25:33 gluefactory INFO] [Validation] {match_recall 0.000E+00, match_precision 0.000E+00, accuracy 6.224E-01, average_precision 0.000E+00, loss/total 7.501E+00, loss/last 7.501E+00, loss/assignment_nll 7.501E+00, loss/nll_pos 1.168E+01, loss/nll_neg 3.325E+00, loss/num_matchable 1.891E+02, loss/num_unmatchable 3.105E+02, loss/row_norm 4.038E-02}
[10/21/2025 00:25:34 gluefactory.utils.experiments INFO] Saving checkpoint checkpoint_best.tar
[10/21/2025 00:25:37 gluefactory INFO] New best val: loss/total=7.501054382324218
Premature end of JPEG file
Premature end of JPEG file
[10/21/2025 00:37:19 gluefactory INFO] [E 0 | it 100] loss {total 3.063E+00, last 2.310E+00, assignment_nll 2.310E+00, nll_pos 3.627E+00, nll_neg 9.934E-01, num_matchable 1.935E+02, num_unmatchable 3.059E+02, confidence 4.681E-01, row_norm 5.083E-01}
[10/21/2025 00:49:00 gluefactory INFO] [E 0 | it 200] loss {total 2.197E+00, last 1.531E+00, assignment_nll 1.531E+00, nll_pos 2.372E+00, nll_neg 6.902E-01, num_matchable 2.006E+02, num_unmatchable 3.004E+02, confidence 4.000E-01, row_norm 6.722E-01}
