nohup: ignoring input
[10/20/2025 23:03:08 gluefactory INFO] Starting experiment sp+lg_selfda_homography
[10/20/2025 23:03:13 gluefactory INFO] Training in distributed mode with 2 GPUs
[10/20/2025 23:03:13 gluefactory INFO] Training in distributed mode with 2 GPUs
[10/20/2025 23:03:14 gluefactory INFO] Using device 0
[10/20/2025 23:03:14 gluefactory INFO] Using device 1
[10/20/2025 23:03:21 gluefactory.datasets.base_dataset INFO] Creating dataset HomographyDataset
[10/20/2025 23:03:21 gluefactory.datasets.base_dataset INFO] Creating dataset HomographyDataset
[10/20/2025 23:03:28 gluefactory.datasets.homographies INFO] Found 1001001 images in list file.
[10/20/2025 23:03:29 gluefactory.datasets.homographies INFO] Found 1001001 images in list file.
/gemini/final/gluefactory/datasets/augmentations.py:130: UserWarning: Argument(s) 'always_apply' are not valid for transform FromFloat
  self.preprocess = A.FromFloat(always_apply=True, dtype="uint8")
/gemini/final/gluefactory/datasets/augmentations.py:131: UserWarning: Argument(s) 'always_apply' are not valid for transform ToFloat
  self.postprocess = A.ToFloat(always_apply=True)
/gemini/final/gluefactory/datasets/augmentations.py:130: UserWarning: Argument(s) 'always_apply' are not valid for transform FromFloat
  self.preprocess = A.FromFloat(always_apply=True, dtype="uint8")
/gemini/final/gluefactory/datasets/augmentations.py:131: UserWarning: Argument(s) 'always_apply' are not valid for transform ToFloat
  self.postprocess = A.ToFloat(always_apply=True)
[10/20/2025 23:03:29 gluefactory INFO] Training loader has 1171 batches
[10/20/2025 23:03:29 gluefactory INFO] Validation loader has 32 batches
[10/20/2025 23:03:32 gluefactory INFO] Parameters with scaled learning rate:
{}
[10/20/2025 23:03:32 gluefactory INFO] Training with mixed_precision=None
No fused RMSNorm
[10/20/2025 23:03:32 gluefactory INFO] Parameters with scaled learning rate:
{}
[10/20/2025 23:03:32 gluefactory INFO] Training with mixed_precision=None
[10/20/2025 23:03:32 gluefactory INFO] Starting training with configuration:
data:
  name: homographies
  data_dir: revisitop1m
  train_size: 150000
  val_size: 2000
  batch_size: 128
  num_workers: 14
  homography:
    difficulty: 0.7
    max_angle: 45
  photometric:
    name: lg
model:
  name: two_view_pipeline
  extractor:
    name: gluefactory_nonfree.superpoint
    max_num_keypoints: 512
    force_num_keypoints: true
    detection_threshold: 0.0
    nms_radius: 3
    trainable: false
  ground_truth:
    name: matchers.homography_matcher
    th_positive: 3
    th_negative: 3
  matcher:
    name: matchers.lightglue_selfda
    filter_threshold: 0.1
    flash: false
    checkpointed: true
train:
  seed: 0
  epochs: 40
  optimizer: adam
  opt_regexp: null
  optimizer_options: {}
  lr: 0.0001
  lr_schedule:
    type: exp
    start: 20
    exp_div_10: 10
    on_epoch: true
    factor: 1.0
    options: {}
  lr_scaling:
  - - 100
    - - dampingnet.const
  eval_every_iter: 500
  save_every_iter: 5000
  log_every_iter: 100
  log_grad_every_iter: null
  test_every_epoch: 1
  keep_last_checkpoints: 10
  load_experiment: null
  median_metrics: []
  recall_metrics: {}
  pr_metrics: {}
  best_key: loss/total
  dataset_callback_fn: null
  dataset_callback_on_val: false
  clip_grad: null
  pr_curves: {}
  plot:
  - 5
  - gluefactory.visualization.visualize_batch.make_match_figures
  submodules: []
benchmarks:
  hpatches:
    eval:
      estimator: opencv
      ransac_th: 0.5
'True': null

[10/20/2025 23:03:32 gluefactory INFO] Starting epoch 0
No fused RMSNorm
