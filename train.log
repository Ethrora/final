nohup: ignoring input
[10/21/2025 23:34:19 gluefactory INFO] Starting experiment sp+lg_selfda_mulit_homography
[10/21/2025 23:34:24 gluefactory INFO] Training in distributed mode with 2 GPUs
[10/21/2025 23:34:24 gluefactory INFO] Training in distributed mode with 2 GPUs
[10/21/2025 23:34:25 gluefactory INFO] Using device 0
[10/21/2025 23:34:25 gluefactory INFO] Using device 1
[10/21/2025 23:34:31 gluefactory.datasets.base_dataset INFO] Creating dataset HomographyDataset
[10/21/2025 23:34:31 gluefactory.datasets.base_dataset INFO] Creating dataset HomographyDataset
[10/21/2025 23:34:37 gluefactory.datasets.homographies INFO] Found 1001001 images in list file.
[10/21/2025 23:34:38 gluefactory.datasets.homographies INFO] Found 1001001 images in list file.
/gemini/final/gluefactory/datasets/augmentations.py:130: UserWarning: Argument(s) 'always_apply' are not valid for transform FromFloat
  self.preprocess = A.FromFloat(always_apply=True, dtype="uint8")
/gemini/final/gluefactory/datasets/augmentations.py:131: UserWarning: Argument(s) 'always_apply' are not valid for transform ToFloat
  self.postprocess = A.ToFloat(always_apply=True)
/gemini/final/gluefactory/datasets/augmentations.py:130: UserWarning: Argument(s) 'always_apply' are not valid for transform FromFloat
  self.preprocess = A.FromFloat(always_apply=True, dtype="uint8")
/gemini/final/gluefactory/datasets/augmentations.py:131: UserWarning: Argument(s) 'always_apply' are not valid for transform ToFloat
  self.postprocess = A.ToFloat(always_apply=True)
[10/21/2025 23:34:38 gluefactory INFO] Training loader has 1171 batches
[10/21/2025 23:34:38 gluefactory INFO] Validation loader has 32 batches
[10/21/2025 23:34:41 gluefactory INFO] Parameters with scaled learning rate:
{}
[10/21/2025 23:34:41 gluefactory INFO] Training with mixed_precision=None
[10/21/2025 23:34:41 gluefactory INFO] Starting training with configuration:
data:
  name: homographies
  data_dir: revisitop1m
  train_size: 150000
  val_size: 2000
  batch_size: 128
  num_workers: 14
  homography:
    difficulty: 0.7
    max_angle: 45
  photometric:
    name: lg
model:
  name: two_view_pipeline
  extractor:
    name: gluefactory_nonfree.superpoint
    max_num_keypoints: 512
    force_num_keypoints: true
    detection_threshold: 0.0
    nms_radius: 3
    trainable: false
  ground_truth:
    name: matchers.homography_matcher
    th_positive: 3
    th_negative: 3
  matcher:
    name: matchers.lightglue_selfda_mulit
    filter_threshold: 0.1
    flash: false
    checkpointed: true
train:
  seed: 0
  epochs: 40
  optimizer: adam
  opt_regexp: null
  optimizer_options: {}
  lr: 0.0001
  lr_schedule:
    type: exp
    start: 20
    exp_div_10: 10
    on_epoch: true
    factor: 1.0
    options: {}
  lr_scaling:
  - - 100
    - - dampingnet.const
  eval_every_iter: 500
  save_every_iter: 5000
  log_every_iter: 100
  log_grad_every_iter: null
  test_every_epoch: 1
  keep_last_checkpoints: 10
  load_experiment: null
  median_metrics: []
  recall_metrics: {}
  pr_metrics: {}
  best_key: loss/total
  dataset_callback_fn: null
  dataset_callback_on_val: false
  clip_grad: null
  pr_curves: {}
  plot:
  - 5
  - gluefactory.visualization.visualize_batch.make_match_figures
  submodules: []
benchmarks:
  hpatches:
    eval:
      estimator: opencv
      ransac_th: 0.5
'True': null

[10/21/2025 23:34:41 gluefactory INFO] Starting epoch 0
[10/21/2025 23:34:41 gluefactory INFO] Parameters with scaled learning rate:
{}
[10/21/2025 23:34:41 gluefactory INFO] Training with mixed_precision=None
Premature end of JPEG file
[10/21/2025 23:36:44 gluefactory INFO] [E 0 | it 0] loss {total 6.988E+00, last 5.450E+00, assignment_nll 5.450E+00, nll_pos 9.906E+00, nll_neg 9.948E-01, num_matchable 1.814E+02, num_unmatchable 3.176E+02, confidence 8.010E-01, row_norm 3.845E-01}
Evaluation:   0%|          | 0/32 [00:00<?, ?it/s]Evaluation:   3%|3         | 1/32 [01:29<46:07, 89.27s/it]Evaluation:   6%|6         | 2/32 [01:34<20:03, 40.10s/it]Evaluation:   9%|9         | 3/32 [01:42<12:05, 25.01s/it]Evaluation:  12%|#2        | 4/32 [01:45<07:38, 16.38s/it]Evaluation:  16%|#5        | 5/32 [01:48<05:12, 11.56s/it]Evaluation:  19%|#8        | 6/32 [01:51<03:47,  8.74s/it]Evaluation:  22%|##1       | 7/32 [01:54<02:52,  6.90s/it]Evaluation:  25%|##5       | 8/32 [01:57<02:17,  5.75s/it]Evaluation:  28%|##8       | 9/32 [02:00<01:51,  4.83s/it]Evaluation:  31%|###1      | 10/32 [02:03<01:33,  4.26s/it]Evaluation:  34%|###4      | 11/32 [02:09<01:36,  4.61s/it]Evaluation:  38%|###7      | 12/32 [02:14<01:37,  4.89s/it]Evaluation:  41%|####      | 13/32 [02:17<01:24,  4.44s/it]Evaluation:  44%|####3     | 14/32 [02:21<01:14,  4.15s/it]Evaluation:  47%|####6     | 15/32 [02:24<01:04,  3.82s/it]Evaluation:  50%|#####     | 16/32 [02:27<00:57,  3.59s/it]Evaluation:  53%|#####3    | 17/32 [02:32<01:01,  4.08s/it]Evaluation:  56%|#####6    | 18/32 [02:35<00:53,  3.79s/it]Evaluation:  59%|#####9    | 19/32 [02:38<00:45,  3.48s/it]Evaluation:  62%|######2   | 20/32 [02:41<00:39,  3.29s/it]Evaluation:  66%|######5   | 21/32 [02:44<00:34,  3.15s/it]Evaluation:  69%|######8   | 22/32 [02:47<00:30,  3.09s/it]Evaluation:  72%|#######1  | 23/32 [02:52<00:33,  3.69s/it]Evaluation:  75%|#######5  | 24/32 [02:55<00:28,  3.50s/it]Evaluation:  78%|#######8  | 25/32 [02:58<00:23,  3.34s/it]Evaluation:  81%|########1 | 26/32 [03:01<00:19,  3.23s/it]Evaluation:  84%|########4 | 27/32 [03:04<00:15,  3.14s/it]Evaluation:  88%|########7 | 28/32 [03:07<00:12,  3.11s/it]Evaluation:  91%|######### | 29/32 [03:10<00:09,  3.05s/it]Evaluation:  94%|#########3| 30/32 [03:13<00:06,  3.04s/it]Evaluation:  97%|#########6| 31/32 [03:16<00:03,  3.03s/it]Evaluation: 100%|##########| 32/32 [03:24<00:00,  4.44s/it]Evaluation: 100%|##########| 32/32 [03:25<00:00,  6.41s/it]
[10/21/2025 23:40:09 gluefactory INFO] [Validation] {match_recall 9.763E-03, match_precision 5.188E-01, accuracy 6.212E-01, average_precision 7.071E-03, loss/total 4.832E+00, loss/last 4.832E+00, loss/assignment_nll 4.832E+00, loss/nll_pos 7.926E+00, loss/nll_neg 1.738E+00, loss/num_matchable 1.922E+02, loss/num_unmatchable 3.072E+02, loss/row_norm 1.976E-01}
[10/21/2025 23:40:10 gluefactory.utils.experiments INFO] Saving checkpoint checkpoint_best.tar
[10/21/2025 23:40:12 gluefactory INFO] New best val: loss/total=4.832266143798828
[10/21/2025 23:47:37 gluefactory INFO] [E 0 | it 100] loss {total 2.915E+00, last 2.120E+00, assignment_nll 2.120E+00, nll_pos 3.324E+00, nll_neg 9.162E-01, num_matchable 1.814E+02, num_unmatchable 3.176E+02, confidence 5.119E-01, row_norm 5.760E-01}
[10/21/2025 23:55:02 gluefactory INFO] [E 0 | it 200] loss {total 1.999E+00, last 1.301E+00, assignment_nll 1.301E+00, nll_pos 1.875E+00, nll_neg 7.270E-01, num_matchable 1.929E+02, num_unmatchable 3.063E+02, confidence 3.948E-01, row_norm 6.939E-01}
Premature end of JPEG file
[10/22/2025 00:02:28 gluefactory INFO] [E 0 | it 300] loss {total 1.865E+00, last 1.198E+00, assignment_nll 1.198E+00, nll_pos 1.749E+00, nll_neg 6.461E-01, num_matchable 1.843E+02, num_unmatchable 3.139E+02, confidence 3.518E-01, row_norm 7.322E-01}
[10/22/2025 00:09:54 gluefactory INFO] [E 0 | it 400] loss {total 1.635E+00, last 9.758E-01, assignment_nll 9.758E-01, nll_pos 1.375E+00, nll_neg 5.764E-01, num_matchable 1.799E+02, num_unmatchable 3.200E+02, confidence 3.346E-01, row_norm 7.795E-01}
[10/22/2025 00:17:18 gluefactory INFO] [E 0 | it 500] loss {total 1.761E+00, last 1.098E+00, assignment_nll 1.098E+00, nll_pos 1.678E+00, nll_neg 5.181E-01, num_matchable 1.813E+02, num_unmatchable 3.175E+02, confidence 3.202E-01, row_norm 7.837E-01}
Evaluation:   0%|          | 0/32 [00:00<?, ?it/s]Evaluation:   3%|3         | 1/32 [01:46<55:16, 106.98s/it]Evaluation:   6%|6         | 2/32 [01:51<23:25, 46.86s/it] Evaluation:   9%|9         | 3/32 [02:00<14:11, 29.35s/it]Evaluation:  12%|#2        | 4/32 [02:03<08:54, 19.08s/it]Evaluation:  16%|#5        | 5/32 [02:07<06:02, 13.43s/it]Evaluation:  19%|#8        | 6/32 [02:10<04:19,  9.97s/it]Evaluation:  22%|##1       | 7/32 [02:13<03:14,  7.79s/it]Evaluation:  25%|##5       | 8/32 [02:16<02:31,  6.32s/it]Evaluation:  28%|##8       | 9/32 [02:20<02:03,  5.36s/it]Evaluation:  31%|###1      | 10/32 [02:23<01:44,  4.76s/it]Evaluation:  34%|###4      | 11/32 [02:29<01:48,  5.19s/it]Evaluation:  38%|###7      | 12/32 [02:35<01:49,  5.49s/it]Evaluation:  41%|####      | 13/32 [02:38<01:29,  4.73s/it]Evaluation:  44%|####3     | 14/32 [02:41<01:14,  4.16s/it]Evaluation:  47%|####6     | 15/32 [02:44<01:05,  3.85s/it]Evaluation:  50%|#####     | 16/32 [02:47<00:57,  3.59s/it]Evaluation:  53%|#####3    | 17/32 [02:53<01:04,  4.28s/it]Evaluation:  56%|#####6    | 18/32 [02:56<00:56,  4.01s/it]Evaluation:  59%|#####9    | 19/32 [02:59<00:47,  3.68s/it]Evaluation:  62%|######2   | 20/32 [03:03<00:42,  3.54s/it]Evaluation:  66%|######5   | 21/32 [03:05<00:36,  3.31s/it]Evaluation:  69%|######8   | 22/32 [03:08<00:31,  3.19s/it]Evaluation:  72%|#######1  | 23/32 [03:13<00:33,  3.78s/it]Evaluation:  75%|#######5  | 24/32 [03:17<00:29,  3.67s/it]Evaluation:  78%|#######8  | 25/32 [03:20<00:24,  3.45s/it]Evaluation:  81%|########1 | 26/32 [03:23<00:19,  3.33s/it]Evaluation:  84%|########4 | 27/32 [03:26<00:15,  3.17s/it]Evaluation:  88%|########7 | 28/32 [03:28<00:12,  3.06s/it]Evaluation:  91%|######### | 29/32 [03:31<00:09,  3.05s/it]Evaluation:  94%|#########3| 30/32 [03:34<00:06,  3.03s/it]Evaluation:  97%|#########6| 31/32 [03:38<00:03,  3.05s/it]Evaluation: 100%|##########| 32/32 [03:38<00:00,  2.40s/it]Evaluation: 100%|##########| 32/32 [03:49<00:00,  7.18s/it]
[10/22/2025 00:21:08 gluefactory INFO] [Validation] {match_recall 8.020E-01, match_precision 6.785E-01, accuracy 8.468E-01, average_precision 5.823E-01, loss/total 9.124E-01, loss/last 9.124E-01, loss/assignment_nll 9.124E-01, loss/nll_pos 1.269E+00, loss/nll_neg 5.559E-01, loss/num_matchable 1.916E+02, loss/num_unmatchable 3.078E+02, loss/row_norm 7.848E-01}
[10/22/2025 00:21:09 gluefactory.utils.experiments INFO] Saving checkpoint checkpoint_best.tar
[10/22/2025 00:21:11 gluefactory INFO] New best val: loss/total=0.9123563299179077
[10/22/2025 00:28:38 gluefactory INFO] [E 0 | it 600] loss {total 1.719E+00, last 1.041E+00, assignment_nll 1.041E+00, nll_pos 1.508E+00, nll_neg 5.736E-01, num_matchable 1.628E+02, num_unmatchable 3.344E+02, confidence 3.315E-01, row_norm 7.848E-01}
[10/22/2025 00:36:04 gluefactory INFO] [E 0 | it 700] loss {total 1.378E+00, last 7.345E-01, assignment_nll 7.345E-01, nll_pos 9.504E-01, nll_neg 5.186E-01, num_matchable 2.054E+02, num_unmatchable 2.940E+02, confidence 3.106E-01, row_norm 8.203E-01}
Premature end of JPEG file
Premature end of JPEG file
[10/22/2025 00:43:29 gluefactory INFO] [E 0 | it 800] loss {total 1.487E+00, last 8.269E-01, assignment_nll 8.269E-01, nll_pos 1.222E+00, nll_neg 4.321E-01, num_matchable 1.853E+02, num_unmatchable 3.141E+02, confidence 2.971E-01, row_norm 8.331E-01}
W1022 00:45:05.671000 21809 site-packages/torch/multiprocessing/spawn.py:169] Terminating process 21884 via signal SIGTERM
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/gemini/final/gluefactory/train.py", line 734, in <module>
    torch.multiprocessing.spawn(
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/multiprocessing/spawn.py", line 340, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/multiprocessing/spawn.py", line 296, in start_processes
    while not context.join():
              ^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/multiprocessing/spawn.py", line 215, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/gemini/final/gluefactory/train.py", line 671, in main_worker
    training(rank, conf, output_dir, args)
  File "/gemini/final/gluefactory/train.py", line 492, in training
    scaler.scale(loss).backward()
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/autograd/graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/glue_factory/lib/python3.12/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 22841) is killed by signal: Killed. 

